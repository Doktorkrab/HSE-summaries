\Subsection{Дифференцируемость функции многих переменных}
\begin{definition}
    $f\!: E \subset \R^n \to R^m$,  $a \in \Int E$.

     $f$ --- дифференцируема в точке  $a$, если  $f(a+h) = f(a) + Th + o(\|h\|)$ при  $h \to \overrightarrow{0}$, где  $T\!: \R^n \to \R^m$ --- линейное отображение.
\end{definition}
\begin{remark}
    Если $f$ дифференцируема в точке  $a$, то  $T$ определена однозначно. 
\end{remark}
\begin{proof}
    $f(a+th) = f(a) + T(th) + o(\|th\|) = f(a) + tTh + o(t\|h\|) = f(a) + tTh + o(t)$. $\|h\|$ --- константа, поэтому можно выкинуть.

     $Th = \lim\limits_{t \to 0} \frac{f(a+th) - f(a)}{t}$
\end{proof}
\begin{remark}
    Если $f$ дифференцируем в точке  $a$, то  $f$ непрерывна в точке  $a$.

     $f(a+h) = f(a) + Th + o(\|h\|) \xrightarrow{h \to 0} f(a)$.
\end{remark}
\begin{definition}
    $T$ --- дифференциал $f$ в точке  $a$. Обозначается  $\mathrm{d}_af$. 
\end{definition}
\begin{definition}
    Матрицу отображения $\mathrm{d}_af$ назовем матрицей Якоби  $f$ в точке  $a$.
\end{definition}

Важный частный случай $m = 1$.  $f(a+h) = f(a) + \langle v, h \rangle + o(\| h\|)$. $v$ --- градиент функции  $f$ в точке  $a$. Обозначается  $\text{grad}\ f$,  $\nabla f(a)$ (набла).

\begin{theorem}
Пусть $f = \begin{pmatrix} f_1 \\ f_2 \\ \vdots \\ f_n \end{pmatrix}\!: E \to \R^m$, $a \in \Int E$.

Тогда $f$ --- дифференцируема в точке  $a \iff f_j$ дифференцируема в точке  $a \forall j$.
\end{theorem} 
\begin{proof}
    $f(a+h) = f(a) + Th + \alpha(h)$, где  $\frac{\alpha(h)}{\|h\|} \xrightarrow{h \to 0} 0$.
    \begin{itemize}
        \item $\Rightarrow$.  $f_j(a+h) = f_j(a) + (Th)_j + \alpha_j(h)$. Надо доказать, что  $\frac{\alpha_j(h)}{\|h\|} \to 0$. $|\alpha_j(h)| \le \|\alpha(h)\|$. Значит, $\frac{|\alpha_j(h)|}{\|h\|} \le \frac{\|\alpha(h)\|}{\|h\|} \to 0$.
        \item $\Leftarrow$. Знаем, что  $f_j(a+h) = f_j(a) + T_jh + \alpha_j(h)$, где  $\frac{\alpha_j(h)}{\|h\|} \to 0$. 

            $\alpha(h) = \begin{pmatrix} \alpha_1(h) \\ \vdots \\ \alpha_m(h) \end{pmatrix}$. Надо доказать, что $\frac{\|\alpha(h)\|}{\|h\|} \to 0$.

            Заметим, что $\frac{\|\alpha(h)\|}{\|h\|} = \frac{\sqrt{\alpha_1(h)^2 + \ldots + \alpha_m(h)^2}}{\|h\|} \le  \frac{|\alpha_1(h)| + \ldots + |\alpha_m(h)|}{\|h\|} \to 0$.
    \end{itemize}
\end{proof}
\begin{consequence}
    Строки матрицы Якоби --- градиенты координатных функций
\end{consequence}
\begin{proof}
    $Th = \begin{pmatrix} T_1 \\ T_2 \\ \vdots \\ T_m \end{pmatrix}(h) = \begin{pmatrix} T_1h \\ \vdots \\ T_mh \end{pmatrix}$.
\end{proof}
\begin{definition}
    Производная по направлению. $f\!: E \to \R, \|h\|=1$.

     $\frac{\partial f}{\partial h}(a) \coloneqq \lim\limits_{t \to 0} \frac{f(a+th) - f(a)}{t}$.
\end{definition}
\begin{remark}
    $\frac{\partial f}{\partial h}(a) = \mathrm{d}_af(h)$.
\end{remark}
\begin{theorem}[экстремальное свойство градиента]
    $\left| \frac{\partial f}{\partial h}(a) \right| \le \|\nabla f(a)\|$, причем равенство достигается при $h = \pm \frac{\nabla f(a)}{\|\nabla f(a)\|}$.
\end{theorem}
\begin{proof}
    $\frac{\partial f}{\partial h}(a) = \mathrm{d}_af(h) = \langle \nabla f(a), h \rangle$.
\\
    $\left| \frac{\partial f}{\partial h}(a) \right| = | \langle \nabla f(a), h \rangle | \le \|\nabla f(a) \| \cdot \|h\| = \|\nabla f(a)\|$.

    В неравенстве Коши-Буняковского равенство $\iff$ векторы пропорциональны  $\implies h = \pm \frac{\nabla f(a)}{\|\nabla f(a)\|}$.
\end{proof}
\begin{definition}
    Частные производные. $f\!: E \to \R$ (это $\iff f$ --- скалярная), $e_k$ --- базисный вектор (везде нули кроме $k$-й позиции).

     $\frac{\partial f}{\partial x_k}, f'_{x_k}, D_{x_k}f,\ldots$. $\frac{\partial f}{\partial x_k} (a) \coloneqq \frac{\partial f}{\partial e_k}(a)$.
\end{definition}
\begin{remark}
    $f(x_1, x_2, \ldots, x_n)$. $\frac{\partial f}{\partial x_1}(a) = \lim\limits_{t \to 0} \frac{f(a_1 + t, a_2, \ldots,a_n) - f(a_1, a_2,\ldots, a_n)}{t} = g'(a_1)$, где $g(s) \coloneqq f(s, a_2, \ldots, a_n)$.
\end{remark}
\begin{example}
    $f(x, y) = x^y$.  $\frac{\partial f}{\partial x} = yx^{y-1}$, $\frac{\partial f}{\partial y} = x^y \cdot \ln x$.
\end{example}
\begin{theorem}
    $\nabla f(a) = \left( \frac{\partial f}{\partial x_1}(a), \frac{\partial f}{\partial x_2}(a), \ldots, \frac{\partial f}{\partial x_n}(a) \right)$.
\end{theorem}
\begin{proof}
   $\frac{\partial f}{\partial h} = \langle \nabla f(a), h \rangle$.

   $\frac{\partial f}{\partial x_k}(a) = \frac{\partial f}{\partial e_k}(a) = \langle \nabla f(a), e_k \rangle = (\nabla f(a))_k$.
\end{proof}
\begin{consequence}
    $f\!: E \subset \R^n \to \R^m$,  $a \in \Int E$,  $f$ --- дифференцируема в точке  $a$.

    Тогда  $f'(a) = 
    \begin{pmatrix} 
    \frac{\partial f_1}{x_1} & \frac{\partial f_1}{x_2} & \ldots & \frac{\partial f_1}{x_n}\\
    \frac{\partial f_2}{x_1} &\frac{\partial f_2}{x_2} & \ldots &\frac{\partial f_2}{x_n}\\ 
    \vdots & \vdots & \ddots & \vdots\\ 
    \frac{\partial f_m}{x_1} & \frac{\partial f_m}{x_2} & \ldots & \frac{\partial f_m}{x_n} 
    \end{pmatrix}$.
\end{consequence}
\begin{theorem}(линейность дифференциала)
    $f, g\!: E \subset \R^n \to \R^m$,  $a \in \Int E$,  $\lambda \in \R$, $f, g$ дифференцируемы в точке $a$.

    Тогда $f + g, \lambda f$ --- дифференцируемы в  $a$ и $\mathrm{d}_a(f+g) = \mathrm{d}_af + \mathrm{d}_ag $ и $\mathrm{d}_a(\lambda f) = \lambda \mathrm{d}_a f$.
\end{theorem}
\begin{proof}
    $f(a+h) = f(a) + \mathrm{d}_af(h) + \alpha(h)$, $\frac{\alpha(h)}{\|h\|} \to 0$, $g(a + h) = g(a) + \mathrm{d}_ag(h) + \beta(h)$, $\frac{\beta(h)}{\|h\|} \to 0$.

    Тогда $f(a+h) + g(a+h) = f(a) + g(a) + \mathrm{d}_af(h) + \mathrm{d}_ag(h) + \alpha(h) + \beta(h)$. Считаем, что  $\alpha(h) + \beta(h) = o(\|h\|)$.

     $\lambda f(a+h) = \lambda f(a) + \lambda \mathrm{d_a}f(h) + \lambda\alpha(h)$.
\end{proof}
\begin{theorem}[дифференцируемость композиции]
    $f\!: E \subset \R^n \to D \subset \R^m$, $g\!: D \subset \R^m \to \R^l$,  $a \in \Int E, b = f(a) \in \Int D$.

    Тогда, если  $f$ дифференцируема в  $a$,  $g$ дифференцируема в  $b = f(a)$, то  $g \circ f$ дифференцируема в точке  $a$ и  $\mathrm{d}_a(g \circ f) = \mathrm{d}_{f(a)}g \circ \mathrm{d}_af$.
\end{theorem}
\begin{proof}
    $f(a+h) = \underbracket{f(a)}_{=b} + \underbracket{\mathrm{d}_af(h) + \alpha(h)}_{=k}$, где  $\frac{\alpha(h)}{\|h\|} \xrightarrow{h \to 0} 0$.

    $g(b+k) = g(b) + \mathrm{d}_bg(k) + \beta(k)$, где  $\frac{\beta(k)}{\|k\|} \xrightarrow{k \to 0} 0$.

    $g \circ f(a + h) = g(b + k) = g(b) + \underbracket{\mathrm{d}_bg(\mathrm{d}_af(h)+\alpha(h))}_{\mathrm{d}_bg(\mathrm{d_af(h)}) + \mathrm{d}_bg(\alpha(h))} = g \circ f(a) + \mathrm{d}_bg \circ \mathrm{d}_af(h) + \mathrm{d}_bg(\alpha(h)) + \beta(k)$.

    Хотим показать, что все корректно.

    $\frac{\|\mathrm{d}_bg(\alpha(h))\|}{\|h\|} \le \|\mathrm{d}_b(g)\| \underbracket{\frac{\|\alpha(h)\|}{\|h\|}}_{\to 0}$. $k = \mathrm{d}_af(h) + \alpha(h)$.  $\|k\| \le \|\mathrm{d}_af(h)\| + \|\alpha(h)\| \le \|\mathrm{d}_af\| \cdot \|h\| + \|\alpha(h)\| \to 0$, откуда $\frac{\|k\|}{\|h\|} \le \|\mathrm{d}_af\| + \frac{\|\alpha(h)\|}{\|h\|}$.

    В итоге, $\frac{\|\beta(k)\|}{\|k\|} \cdot \frac{\|k\|}{\|h\|} \xrightarrow{h \to 0} 0$.
\end{proof}
\begin{consequence}
    $(g \circ f)'(a) = g'(f(a)) f'(a)$.
\end{consequence}
\begin{theorem}[Дифферециал произведения скалярной и векторной функции]
    $E \subset \R^n, a \in \Int E$,  $\lambda\!: E \to \R, f\!: E \to \R^m$,  $\lambda$ и  $f$ дифференцируемы в точке  $a$. Тогда  $\lambda f$ дифференцируема в точке  $a$ и  $\mathrm{d}_a(\lambda f)(h) = \mathrm{d}_a \lambda(h) f(a) + \lambda(a) \cdot \mathrm{d}_af(h)$.
\end{theorem}
\begin{proof}
    $f(a+h) = f(a) + \mathrm{d}_af(h) + \alpha(h)$,  $\frac{\alpha(h)}{\|h\|} \to 0$. $\lambda(a + h) = \lambda(a) + \mathrm{d}_a\lambda(h) + \beta(h), \frac{\beta(h)}{\|h\|} \to 0$.

    $\lambda(a+h)f(a+h) = \lambda(a)f(a) + {\color{orange}\mathrm{d}_a\lambda(h)f(a) + \lambda(a)\mathrm{d}_af(h)} + {\color{purple}\mathrm{d}_a\lambda(h)\cdot \mathrm{d}_af(h)} + \lambda(a) \cdot \alpha(h) + f(a) \beta(h) + {\color{blue}\mathrm{d}_af(h)\beta(h)} + {\color{olive}\mathrm{d}_a\lambda(h)\alpha(h)} +\alpha(h)\beta(h)$. 

    Заметим, что {\color{orange}второе и третье} слагаемые очевидно подходят под наше свойство. Теперь заметим, что  {\color{purple}$\text{const} \cdot \|h\|^2 = o(\|h\|)$} и  {\color{blue}$\text{const} \cdot \|h\| \beta(h) = o(\|h\|)$} и  {\color{olive}$\text{const} \|h\| \|\alpha(h)\| = o(\|h\|)$}. И всё получается. 
\end{proof}
\begin{theorem}[о дифференциале скалярного произведения]
    $f, g\!: E \to \R^m, a \in \Int E$,  $f, g$ --- дифференцируемы в  $a$. 

    Тогда  $\langle f, g\rangle$ дифференцируемы в  $a$. $\mathrm{d}_a \langle f, g \rangle(h) = \langle \mathrm{d}_af(h), g(a) \rangle + \langle f(a), \mathrm{d}_ag(h) \rangle$.
\end{theorem}
\begin{proof}
    $\langle f(x), g(x) \rangle = \sum\limits_{j=1}^m f_j(x) g_j(x)$.

     $\mathrm{d}_a\langle f, g \rangle(h) = \sum\limits_{j=1}^m \mathrm{d}_a(f_jg_j)(h) = \sum\limits_{j=1}^m (\mathrm{d}_a g_j(h)f_j(a) + g_j(a) \mathrm{d}_af_j(h)) = \sum\limits_{j=1}^m f_j(a) \mathrm{d}_ag_j(h) + \sum\limits_{j=1}^m \mathrm{d}_a f_j(h)g_j(a) = \langle f(a), \mathrm{d}_ag(h)\rangle + \langle \mathrm{d}_a f(h), g(a) \rangle$.
\end{proof}
\begin{remark}
    При $n=1$  $\langle f, g \rangle'(a) = \langle f'(a), g(a)\rangle + \langle f(a), g'(a) \rangle$.
\end{remark}
\begin{theorem}[Лагранжа для векторнозначных функций]
    $f\!: [a, b] \to \R^m$,  $f$ --- дифференцируема во всех точках из  $(a, b)$ и непрерывна на  $[a, b]$.

    Тогда существует  $c \in (a, b)$, такая что  $\|f(b) - f(a)\| \le \|f'(c)\|(b-a)$.
\end{theorem}
\begin{proof}
    $\vphi(t) \coloneqq \langle f(t), f(b) - f(a) \rangle$ --- дифференцируемая функция  $\implies \exists c \in (a, b)\!: \|f(b) - f(a)\|^2 = \langle f(b), f(b) - f(a) \rangle - \langle f(a), f(b) - f(a) \rangle = \vphi(b) - \vphi(a)= \vphi'(c)(b-a) = (b-a) \langle f'(c), f(b) - f(a) \rangle \le (b-a) \|f'(c)\|\|f(b) - f(a)\|$.\\
    $\vphi'(t) = \langle f'(t), f(b) - f(a) \rangle$.
\end{proof}
\begin{example}
    $m = 2$,  $[a, b] = [0, 2\pi], f(t) = \begin{pmatrix} \cos t \\ \sin t \end{pmatrix}, f'(t) = \begin{pmatrix} -\sin t \\ \cos t \end{pmatrix}$. $f(2\pi) - f(0) = \overrightarrow{0}$,  $\|f'(t)\| = 1$. Тогда получаем  $\|f(2\pi) - f(0)\| = 0 < 2\pi\|f'(c)\|$.

    Тут не достигается равенства вообще никогда.
\end{example}
\Subsection{Непрерывная дифференцируемость}
\begin{theorem}
    $f\!: E \subset \R^n \to \R$,  $a \in \Int E$. Все частные производные функции  $f$ существуют в окрестности  $a$ и непрерывны в ней. Тогда  $f$ дифференцируема в точке  $a$.
\end{theorem}
\begin{proof}
    $f(a+h) - f(a) = \sum\limits_{i=1}^n \frac{\partial f}{x_i}(a) h_i + o(\|h\|)$, $R(h) = f(a + h) - f(a) - \sum\limits_{i=1}^n \frac{\partial f}{\partial x_i}(a) h_i$.

    Хочется показать, что $R(h) = o(\|h\|)$, тогда мы победили и дифференцируемость есть.

    $b_0 = a, b_1 = (a_1 + h, a_2, \ldots, a_n), b_k = (a_1 + h_1, a_2 + h_2, \ldots, a_k + h_k, a_{k+1}, \ldots, a_n).$

    $f(b_k) - f(b_{k-1}) = f(a_1 + h_1, \ldots, a_{k-1} + h_{k-1}, a_k + h_k, a_{k+1}, \ldots, a_n) - f(a_1 + h_1, \ldots, a_{k-1} + h_{k-1}, a_k, \ldots, a_n) = h_k \frac{\partial f}{\partial x_k}(b_{k-1} + \Theta_k h_k e_k)$ ($0 < \Theta_k < 1$). Здесь $b_{k-1} +\Theta_k h_k e_k$ --- какая-то точка из  $(a_{k}, a_{k} + h_k)$ полученная путем теоремы Лагранжа.

    Тогда $f(a + h) - f(a) = f(b_n) - f(b_0) = \sum\limits_{k=1}^n h_k \frac{\partial f}{\partial x_k}(b_{k-1} + \Theta_k h_ke_k) = \sum\limits_{k=1}^n h_k \frac{\partial f}{\partial x_k}(a) + \sum\limits_{k=1}^nh_k(\frac{\partial f}{\partial x_k}(b_{k-1} + \Theta_k h_k e_k) - \frac{\partial f}{\partial x_k}(a))$.

    Тогда $|R(h)| = \left|\sum\limits_{k=1}^n h_k \left( \frac{\partial f}{\partial x_k}(b_{k-1} + \Theta_k h_k e_k) - \frac{\partial f}{\partial x_k}(a)\right)\right| \le \|h\| (\sum(...)^2)^{\frac{1}{2}}$, а $(\sum(...)^2)^{\frac{1}{2}} \to 0$ при $h \to 0$ из непрерывности частных производных.
\end{proof}
\begin{remark}
    Дифференциал функции в точке не влечет существования частных производных (и даже непрерывности) в окрестности точки. 

    Пример: $f(x, y) = \begin{cases} x^2 + y^2 & \text{если } x,y\in\Q\\ 0 & \text{иначе} \end{cases}$. Дифференциал в точке $(0, 0)$:  $f(x, y) = f(0, 0) + o(\sqrt{x^2 + y^2})$ при  $(x, y) \to (0, 0)$.
\end{remark}
\begin{definition}
$f\!: E \subset \R^n \to \R^m$  $f$ непрерывно дифференцируема, если она дифференцируема в каждой точке и  $\dd_xf$ непрерывно зависит от точки, то есть $\|\dd_xf - \dd_af\| \to 0$  при $x \to a$.
\end{definition}
\begin{theorem}
    $f$ непрерывно дифференцируема  $\iff$  $f$ дифференцируема во всех точка и все частные производные непрерывны. 
\end{theorem}
\begin{remark}
    $A = \begin{pmatrix} a_{11} & \ldots & a_{1m}\\ \vdots & \ddots & \vdots \\ a_{n_1} & \ldots & a_{nm} \end{pmatrix}$, $a_{jk} = \langle Ae_k, e_j \rangle$,  $|a_{jk}| = |\langle A_{e_k}, e_j \rangle| \le \|Ae_k\| \underbrace{\|e_j\|}_{=1} \le \|A\| \cdot \|e_k\| = \|A\|$.
\end{remark}

\begin{proof}
    \begin{itemize}
        \item $\Rightarrow$. $\|\dd_xf - \dd_af\| \to 0$. \\ Матрица для  $\dd_xf - \dd_af = \begin{pmatrix} \frac{\partial f_1}{\partial x_1}(x) - \frac{\partial f_1}{\partial x_1}(a) & \ldots & \frac{\partial f_1}{\partial x_n}(x) - \frac{\partial f_1}{\partial x_n}(a) \\ \vdots & \ddots & \vdots \\ \frac{\partial f_m}{\partial x_1}(x) - \frac{\partial f_m}{\partial x_1}(a) & \ldots & \frac{\partial f_m}{\partial x_n}(x) - \frac{\partial f_m}{\partial x_n}(a) \end{pmatrix}$. $\left|\frac{\partial f_j}{\partial x_k}(x) - \frac{\partial f_j}{\partial x_k}(a)\right| \le \|\dd_xf-\dd_af\| \xrightarrow{x\to a} 0 \implies \frac{\partial f_j}{\partial x_k}$ непрерывна в $a$.
        \item $\|\dd_xf - \dd_af\|^2 \le \sum\limits_{j=1}^m \sum\limits_{k=1}^n \left( \frac{\partial f_j}{\partial x_k}(x) - \frac{\partial f_j}{\partial x_k}(a) \right)^2 \to 0$. 
   \end{itemize} 
\end{proof}
\begin{consequence}
   $f$ --- непрерывно дифференцируема  $\iff$ существуют все частные производные и они непрерывны.
\end{consequence}
\begin{theorem}
    Линейная комбинация, композиция, скалярное произведение, непрерывной дифференцируемой функции --- непрерывно дифференцируема.
\end{theorem}
\Subsection{Частные производные высших порядков}
\begin{definition}
    $f\!: E \subset \R^n \to \R, f(x_1, x_2, \ldots, x_n)$.

    $\frac{\partial f}{\partial x_j}\!: E \to \R$. Тогда считаем, что $\frac{\partial^2 f}{\partial x_i \partial x_j}(x) = \frac{\partial}{\partial x_i}\left(\frac{\partial f}{\partial f)j}\right)$
\end{definition}
\begin{definition}[Обозначения]
    $f''_{x_j, x_i}$ или  $D_{x_i, x_j}f$.    

    $\frac{\partial^r f}{\partial x_{i_r} \partial x_{i_{r-1}} \ldots \partial x_{i_1}} \coloneqq \frac{\partial}{\partial x_{i_r}} \left( \frac{\partial^{r-1}}{\partial x_{i_{r-1}} \ldots x_{i_1}}\right)$
\end{definition}
\begin{remark}
    Всего $n^r$ частных производных порядка $r$.
\end{remark}
\begin{example}
    $f(x, y) = x^y$,  $\frac{\partial f}{\partial x} = y x^{y-1}$, $\frac{\partial f}{\partial y} = x^y \ln x$.

    $\frac{\partial^2 f}{\partial x^2} = y(y-1)x^{y-2}$

    $\frac{\partial^2 f}{\partial y^2} = x^y (\ln x)^2$.

    $\frac{\partial^2 f}{\partial y \partial x} = x^{y-1} + y x^{y-1} \ln x$.

    $\frac{\partial^2 f}{\partial x \partial y} = x^{y-1} + y x^{y-1} \ln x$.
\end{example}
\begin{example}
    $f(x, y) = \begin{cases} xy \frac{x^2 - y^2}{x^2 + y^2} & \text{если } x^2 + y^2 \neq 0\\ 0 & \text{иначе} \end{cases}$.

    $\frac{\partial f}{\partial x}(x, y) = \left( \frac{x^2y - xy^2}{x^2+y^2}\right)'_X = \frac{(3x^2y-y^3)(x^2+y^2) - 2x(x^3y-xy^3)}{(x^2+y^2)^2} = \frac{x^4y-y^5+4x^2y^3}{(x^2+y^2)^2}$.

    $\frac{\partial f}{\partial x}(0, 0) = \lim\limits_{x \to 0} \frac{f(x, 0) - f(0, 0)}{x} = \lim\limits_{x \to 0} \frac{0 - 0}{x} = 0$.

    $\frac{\partial^2 f}{\partial y \partial x}(0, 0) = \lim\limits_{y \to 0} \frac{\frac{\partial f}{\partial x}(0, y - \frac{\partial f}{\partial x}(0, 0))}{u} = \lim\limits_{y \to 0}\frac{-y - 0}{y} = -1$. А если в другом порядке, то 1.
\end{example}
\begin{theorem}
    $f\!: E \subset \R^2 \to \R, (x_0, y_0) \in \Int E$.

    $f'_x, f'_y, f''_{xy}$ существуют в окрестности  точки  $(x_0, y_0)$ и $f_{xy}''$ непрерывны в точке  $(x_0, y_0)$.

    Тогда существует $f''_{yx}(x_0, y_0)$ и $f''_{xy}(x_0, y_0) = f''_{yx}(x_0, y_0)$.
\end{theorem}
\begin{proof}
    $\vphi(s) \coloneqq f(s, y_0 + k) - f(s, y_0)$, $\vphi'(s) = f'_x(s, y_0 + k) - f'_x(s, y_0)$.

    $\vphi(x_0+h) - \vphi(x_0) = h\vphi'(x_0 + \Theta h) = h(f'_x(x_0 + \Theta h, y_0 + k) - f'_x(x_0 + \Theta h, y_0)) = hk f''_{xy}(x_0 + \Theta h, y_0 + \widetilde{\Theta}k)$, где $0 < \widetilde{\Theta} < 1$.

    $\frac{\vphi(x_0 + h) - \vphi(x_0)}{hk} - f''_{xy}(x_0, y_0) = f''_{xy}(x_0 + \Theta h, y_0 + \widetilde{\Theta}k) - f''_{xy}(x_0, y_0) \to 0$, при $(h, k) \to (0, 0)$.

    При малых $h$ и  $k$:
    \begin{align*}
    &\left| \frac{1}{h} \left(\frac{\vphi(x_0 + h)}{k} - \frac{\vphi(x_0)}{k}\right) - f''_{xy}(x_0, y_0) \right| < \eps
    \xrightarrow{k \to 0} \left| \frac{1}{h} \left( f'_y(x_0+h, y_0) - f'_y(x_0, y_0) \right) - f''_{xy}(x_0, y_0) \right| \le 0 \\
    & \implies \lim\limits_{h \to 0} \frac{f'_y(x_0+h, y_0) - f'_y(x_0, y_0)}{h} = f''_{xy}(x_0, y_0).
    \end{align*}
\end{proof}
\begin{definition}
    $f\!: D \subset \R^n \to \R$ ($D$ --- открытое), $f$  $r$ раз непрерывно дифференцируема, если у нее существуют все частные производные порядка  $\le r$ и они непрерывны.

    Обозначение. $f \in C^r(D)$.
\end{definition}
\begin{theorem}
    $f \in C^r(D)$ и $(i_1, i_2, \ldots, i_r)$ перестановка $(j_1, j_2,\ldots,j_r)$.

Тогда $\frac{\partial^r f}{\partial x_{i_r}\ldots\partial x_{i_1}} = \frac{\partial^r f}{\partial x_{j_r} \ldots \partial x_{j_1}}$.
\end{theorem}
\begin{proof}
    Достаточно доказать данное утверждение для одной транспозиции ($a, b \to b, a$), тогда заметим, что у на есть общий префикс + общий суффикс + пара различных переменных. 

    Тогда, воспользовавшись предыдущей теоремой можно понять, что все хорошо.
\end{proof}
\begin{definition}
    Мультииндекс $k = (k_1, k_2, \ldots, k_n)$ --- набор из $n$ неотрицательных чисел.

    $k! \coloneqq k_1!k_2!\ldots k_n!$, $|k| \coloneqq k_1 + k_2 + \ldots + k_n$ --- высота мультииндекса.

    $\binom{|k|}{k_1, k_2, \ldots, k_n} =  \frac{|k|!}{k!}$.

    $h=(h_1, h_2, \ldots, h_n), h^k \coloneqq h_1^{k_1}\ldots h_n^{k_n}$.

    $f^{(k)} = \frac{\partial^{|k|} f}{\partial x_1^{k_1} \ldots \partial x_n^{k_n}}$.
\end{definition}

\begin{lemma}
    $f \in C^r(D), D \subset \R^n, D$ --- открытое,  $[x, x + h] \subset D, F(t) \coloneqq f(x+th), t \in [0; 1]$.

    Тогда $F \in C^r[0, 1]$ и  $F^{(l)}(t) = \sum\limits_{|k| = l} \frac{l!}{k!}f^{(k)}(x + th)h^k$.
\end{lemma}
\begin{proof}
    $g \in C^1(D), G(t) = g(x+th)$.  $G'(t) = \sum\limits_{j=1}^n g'_{x_j}(x+th) h_j$.  $v(t) \coloneqq x+th$.
    Тогда, $G(t) = g(v(t))$, а значит: 
    \begin{align*}
        G'(t) = g'(v(t))v'(t) = g'(x+th)h= \begin{pmatrix} g'_{x_1}(x+th) & \ldots & g'_{x_n}(x+th) \end{pmatrix} \begin{pmatrix} h_1 \\ h_2 \\ \vdots \\ h_n \end{pmatrix} = \sum\limits_{j=1}^n g'_{x_j}(x+th)h_j.
    \end{align*}

    А значит $F^{(l)}(t) = \sum\limits_{j_l=1}^n \sum\limits_{j_{l-1}=1}^n \ldots \sum\limits_{j=1}^n f^{(l)}_{x_{j_1}, x_{j_2}, \ldots, x_{j_l}}(x+th)h_{j_1}h_{j_2}\ldots h_{j_l} = \sum\limits_{|k| = l} \frac{l!}{k!} f^{(k)}(x+th)h^k$. Просто в $f^{(l)}_{x_{j_1}, x_{j_2}, \ldots, x_{j_l}}$ $k_1$ раз $x_1$, $k_2$ раз $x_2$, \ldots
\end{proof}
\begin{theorem}[Многомерная формула Тейлора (с остатком в форме Лагранжа)]
    $f \in C^{n+1}(D), D \subset \R^n$,  $D$ --- открытое,  $f\!: D \to \R, [x, x+h] \subset D$. 

    Тогда существует  $\Theta \in (0, 1)$, что  $f(x+h) = \sum\limits_{|k| \le r} \frac{f^{(k)}(x)}{k!}h^k + \sum\limits_{|k| = r+1} \frac{f^{(k)}(x + \Theta h)}{k!} h^k$.
\end{theorem}
\begin{proof}
    $F(t) \coloneqq f(x+th)$,  $F(1) = \underbrace{\sum\limits_{l=0}^r \frac{F^{(l)}(0)}{l!}1^l}_{=\sum\limits_{|k|=l} \frac{f^{(k)}(x)}{k!}h^k} + \underbrace{\frac{f^{(k+1)}(\Theta)}{(k+1)!}1^{r+1}}_{\sum\limits_{|k|=r+1} \frac{f^{(k)}(x+\Theta h)}{k!}h^k}$
\end{proof}
\begin{remark}
\begin{enumerate}
    \item Многочлен Тейлора степени $r$.  $\sum\limits_{|k| \le r} \frac{f^{(k)}(a)}{k!}(x-a)^k$.
    \item $r=0$. Многомерная формула Лагранжа. 

        $f(x+h) = f(x) + \sum\limits_{j=1}^n f'_{x_j}(x+\Theta h)h_j = f(x) + \langle \nabla f(x + \Theta h), h \rangle$.
    \item $n=2$ в координатной записи.

        $f(x, y) = f(a, b) + f'_x(a, b)(x-a) + f'_y(a, b)(y-b)  + \frac{1}{2}f''_{xx}(a, b)(x-a)^2 + \frac{1}{2} f''_{yy}(a, b)(y-b)^2 + f''_{xy}(a, b)(x-a)(y-b) + \ldots$.
\end{enumerate}    
\end{remark}
\begin{theorem}[с остатком в форме Пеано]
    $f \in C^r(D), a \in D \subset \R^n$,  $D$ --- открытое. Тогда при  $x \to a$

    $f(x) = \sum\limits_{|k| \le r} \frac{f^{(k)}(a)}{k!}(x-a)^k + o(\|x-a\|^r)$.
\end{theorem}
\begin{proof}
    Пишем формулу с остатком в форме Лагранжа для $r-1$.

    \begin{align*}
        f(x) &= \sum\limits_{|k| \le r-1} \frac{f^{(k)}(x)}{k!}(x-a)^k + \sum\limits_{|k| = r} \frac{f^{(k)}(a + \Theta(x-a))}{k!}(x-a)^k = \\ &= \sum\limits_{|k| \le r} \frac{f^{(k)}(a)}{k!}(x-a)^k + \underbracket{\sum\limits_{|k| = r} \frac{f^{(k)}(a + \Theta(x-a)) - f^{(k)}(a)}{k!}(x-a)^k}_{=o(\|x-a\|^r)}.
    \end{align*}
    Достаточно проверить, что $\underbrace{(f^{(k)}(a+\Theta(x-a)) -f^{(k)}(a))}_{\xrightarrow{x \to a} 0}(x-a)^k= o(\|x-a\|^r)$.

    Надо понять, что  $|(x-a)^k| \le \|x-a\|^r$. Заметим, что $|x_j - a_j| \le \|x-a\|$, тогда можно воспользоваться определением мультииндекса.
\end{proof}
\begin{consequence}[Полиномиальная (мультиномиальная) формула]
    $(x_1 + x_2 + \ldots + x_n)^r = \sum_{|k| = r} \frac{r!}{k!}x^k = \sum_{|k| = r} \binom{r}{k_1, k_2, \ldots, k_n} x_1^{k_1}\ldots x_n^{k_n}$.
\end{consequence}
\begin{proof}
    $f(x) = (x_1 + x_2 + \ldots + x_n)^r = g^r(x)$, где $g(x) = x_1 + \ldots + x_n$.

    $f'_{x_j}(x) = rg^{r-1}(x) g'_{x_j}(x) = r g^{r-1}(x)$. Знаем, что если $|k| = r$, то  $f^{(k)}(x) = r!$. А если  $<$, то  $f^{(k)}(x) = \ldots \cdot g^{r-|k|}(x), f^{(k)}(0) = 0$.
\end{proof}
\Subsection{Обратные и неявные функции}
\begin{definition}
    $(X, \rho)$ --- метрическое пространство,  $f\!: X \to X$.  $f$ --- сжатие с коэффициентом $\lambda$, если  $\rho(f(x), f(y)) \le \lambda \rho(x, y)$, где $0 < \lambda < 1$.
\end{definition}
\begin{theorem}[Банаха о сжатии]
    Пусть $X$ --- полное метрическое пространство,  $f$ --- сжатие.

    Тогда у  $f$ существует единственная неподвижная точка, то есть  $\exists! x\!: f(x) = x$.
\end{theorem}
\begin{proof}
    Единственность. Пусть $x$ и  $y$ --- неподвижные точка. Тогда  $\rho(f(x), f(y)) = \rho(x, y)$, но при это  $\rho(f(x), f(y)) \le \lambda\rho(x, y) \implies \rho(x, y) = 0 \implies x = y$.

    Существование. Построим последовательность $x_n$.  $x_0 \in X, x_{n+1} \coloneqq f(x_n)$.

    Докажем, что последовательность  $x_n$ --- фундаментальная.  $\rho(x_{n+k}, x_n) = \rho(f(x_{n+k-1}), f(x_{n-1}))) \le \lambda \rho(x_{n+k-1}, x_{n-1}) \le \ldots \le \lambda^n \rho(x_k, x_0)$. 

    Посмотрим на $\rho(x_k, x_0) \le \rho(x_k, x_{k-1}) + \rho(x_{k-1}, x_{k-2}) + \ldots + \rho(x_1, x_0) \le (\lambda^{k-1} + \lambda^{k-2} + \ldots + \lambda +1) \rho(x, x_0) < \frac{\rho(x_1, x_0)}{1-\lambda}$. А значит, $\lambda^n \rho(x_{k}, x_0) \le \frac{\lambda^n}{1-\lambda} \rho(x_1, x_0) \le C\lambda^n$. А значит последовательность фундаментальная.

    Тогда $\exists x_* \in X\!: \lim x_n = x_*$. $x_* \leftarrow x_{n+1} = f(x_n) \to f(x_*)$. 

    Сжатие непрерывно по определению, тогда $x_* = f(x_*)$.
\end{proof}
\begin{remark}
    $\rho(x_*, x_n) \le \frac{\lambda^n}{1 - \lambda}\rho(x_1, x_0) \implies \rho(x_*, x_n) \le \lambda^n \rho(x_*, x_0)$.
\end{remark}
\begin{consequence}
    Пусть $f, g$ --- сжатия с коэффициентами $\lambda$,  $x, y$ их неподвижные точки.

    Тогда $\rho(x, y) \le \frac{\rho(f(x), g(x))}{1-\lambda}$.
\end{consequence}
\begin{proof}
    $\rho(x, y) = \rho(f(x), g(y)) \le \rho(f(x), g(x)) + \underbrace{\rho(g(x), g(y))}_{\le \lambda \rho(x, y)} \implies (1-\lambda)\rho(x, y) \le \rho(f(x), g(x))$.
\end{proof}
\begin{example}[Метод касательных Ньютона]
    Мы знаем, что $\exists a\!: f(a) = 0$, но не знаем  $a$, но зато знаем, что  $f\!: [a, x_0] \to \R, f\uparrow, f$ --- выпукла, $f \in C^2$.

    $g(x) \coloneqq x - \frac{f(x)}{f'(x)}$. Сразу требование: $f'(a) = \mu > 0$. Тогда будем делать  $x_{n+1} \coloneqq g(x_n)$, Если $x_*$ --- неподвижная точка, то  $g(x_*) = x_* \iff x_* - \frac{f(x_*)}{f'(x_*)} \implies f(x_*) = 0$.

    Картинка\dots (Она показывает, что 0 $g(x)$ --- пересечение касательной с осью  $OX$), то есть мы так итеративно двигаемся к корню. Или, если формально:
    \[y = f'(x_k)(x-x_k) + f(x_k) \implies 0 = f'(x_k)(x-x_k) + f(x_k) \implies x = x_k - \frac{f(x_k)}{f'(x_k)}.\]

    $f(x) = f(x) - f(a) = f'(c)(x-a) < f'(x)(x-a)$ (теорема Лагранжа для получения $c \in (a, x)$) $\Leftarrow f'(c) \le f'(x)$, так как $f$ выпукла.

    Теперь покажем, что $g$ --- хорошая функция
    $\frac{f(x)}{f'(x)} < x-a \implies a < x - \frac{f(x)}{f'(x)} = g(x) \implies g\!: [a, x_0] \to [a, x_0]$.

    А теперь покажем, что наша функция --- сжатие: $g(x) - g(y) = g'(c)(x-y)$,  $g'(x) = 1 - \frac{f'(x) f'(x) - f(x)f''(x)}{f'(x)^2} = \frac{f(x)f''(x)}{f'(x)^2}$. $M = \max\limits_{a \le x \le x_0} f''(x)$, $1 > \frac{Mf(x_0)}{\mu^2} \eqqcolon \lambda \ge g'(x)$. Следовательно, $\exists! x^*$, а это значит, что мы можем найти корень!

    Но, штука может быть $>1$, это регулируется  $x_0$, которую можно аккуратнее искать. Получили оценку порядка  $\lambda^n$.

     $f(x) < f'(x)(x-a) \implies 0 \le \frac{f'(x)(x-a)f''(x)}{f'(x)^2} = \frac{f''(x)(x-a)}{f'(x)} \le \frac{M(x_0 - a)}{\mu}$ --- нашли границу для стартовой точки.

     \begin{exerc}
         Доказать, что $x_{n+1} - a \le \frac{M}{2\mu}(x_n-a)^2 \implies x_n -a \le \frac{2\mu}{M}(\frac{M}{2\mu}(x_n-a))^{2^n}$.
     \end{exerc}
\end{example}
\begin{remark}
    $f(x) = x^k - b$,  $g(x) = x - \frac{x^k - b}{kx^{k-1}} = x - \frac{x}{k} + \frac{b}{kx^{k-1}} = (1-\frac{1}{k}x)+\frac{b}{kx^{k-1}}$.
\end{remark}
\begin{definition}
    $f\!: D \subset \R^2 \to \R, D$ --- открытое, $\exists (x_0, y_0) \in D$.

     Задача Коши: $
\begin{cases}
    y'(x) = f(x, y(x))\\
    y(x_0) = y_0
\end{cases}
     $
\end{definition}
\begin{theorem}[Пикара]
    $f\!: D \subset \R^2 \to \R$,  $D$ --- открытое,  $(x_0, y_0) \in D$, $|f(x, y) - f(x, \widetilde{y})| \le M |y-\widetilde{y}|\ \forall x, y, \widetilde{y}$, $f$ --- непрерывна.

    Тогда  $\exists \delta > 0$, что на  $[x_0 - \delta, x_0 + \delta]$ задача Коши имеет единственное решение.
\end{theorem}
\begin{remark}
    $\begin{cases} y' = -y^2\\y(1) = 1 \end{cases} \implies y(x) = \frac{1}{x}$. В нуле беды с бедами.
\end{remark}
\begin{proof}[Доказательство теоремы]
    $\vphi\!: [x_0-\delta, x_0 + \delta] \to \R$,  $\vphi'(x) = f(x, \vphi(x)) \land \vphi(x_0) = y_0$. Переформулируем: $\vphi(x) = y_0 + \int\limits_{x_0}^x f(t, \vphi(t)) \dt$.

    Тогда $T(\vphi) \coloneqq \psi, \psi(x) \coloneqq y_0 + \int\limits_{x_0}^x f(t, \vphi(t)) \dt$ (правило для построения последовательности из теоремы Банаха). То есть $\vphi_{n+1} \coloneqq T(\vphi_n)$.

    Возьмем  $\overline{B}_r(x_0, y_0) \subset D$,  $|f(x, y)| \le K$ (такое есть, потому что функция непрерывна, да еще и отрезок) на $\overline{B}_r(x_0, y_0)$. Выберем $\delta > 0$, такое что 
    \begin{enumerate}
        \item $\delta M < 1$,
        \item  $|x - x_0| \le \delta, |y-y_0| \le K\delta \implies (x, y) \in \overline{B}_r(x_0, y_0)$
    \end{enumerate}
    Возьмем $C_* \coloneqq \{ \vphi\!: [x_0 -\delta, x_0 + \delta] \to \R, \vphi \in C[x_0 - \delta, x_0 + \delta]\!: |\vphi(x) - y_0| \le K\delta\} \subset C[x_0-\delta, x_0 + \delta]$. Заметим, что $C_*$ --- замкнутое, а значит полное.

    Надо доказать, что $T\!: C_* \to C_*$ и это сжатие.

    Возьмем $\psi = T\vphi$, проверим, что $|\psi(x) - y_0| \le K\delta \iff |\int\limits_{x_0}^x f(t, \vphi(t))| \le K\delta$.

    $T$ --- сжатие  $ \iff |\psi(x) - \widetilde{\psi}(x)| = |y_0 + \int\limits_{x_0}^x f(t, \vphi(t))\dt - y_0 -\int\limits_{x_0}^x f(t, \widetilde{\vphi}(t)) \dt| \le \int\limits_{x_0}^x |f(t, \vphi(t)) - f(t, \widetilde{\vphi}(t))| \dt \le \int\limits_{x_0}^x M|\vphi(t) - \widetilde{\vphi}(t)|\dt \le \underbrace{\delta M}_{< 1} \|\vphi - \widetilde{\vphi}\|$
\end{proof}
\begin{theorem}
    Пусть $A\!: \R^n \to \R^n$,  $A$ --- линейное,$m > 0$,  $\|Ax\| \ge m \|x\|\ \forall x$.

    Тогда $A$ --- обратим и  $\|A^{-1}\| \le \frac{1}{m}$.
\end{theorem}
\begin{proof}
    $A$ --- инъекция. Так как линейно достаточно понять, что  $Ax = 0 \implies x = 0$. $Ax = 0 \implies \|Ax\| = 0, \|Ax\| \ge m\|x\| \implies \|x\| = 0 \implies x = 0$.

    Так как $A$ --- инъекция  $\implies A$ --- суръекция $\implies A$ --- биекция, значит обратим. 

    $\|A^{-1}\| = \sup\limits_{x \neq 0} \frac{\|A^{-1}x\|}{\|x\|} \overset{(*)}{=} \sup\limits_{y \neq 0} \frac{\|A^{-1}Ay\|}{\|Ay\|} = \sup\limits_{y \neq 0} \frac{\|y\|}{\|Ay\|} \le \frac{1}{m}$. так как $\|Ay\| \ge m \|y\|$. $(*)$ --- так как биекция, то существует  $y\!: x = Ay$.
\end{proof}
\begin{theorem}[Теорема об операторах, близких к обратным]
    $A, B\!: \R^n \to \R^n$,  $A$ --- обратим и  $\|B-A\| < \frac{1}{\|A^{-1}\|}$.

    Тогда:
    \begin{enumerate}
        \item $B$ --- обратим,
        \item  $\|B^{-1}\| \le \frac{1}{\frac{1}{\|A^{-1}\|}- \|B-A\|}$,
        \item $\|B^{-1} - A^{-1}\| \le \frac{\|B-A\| \cdot \|A^{-1}\|}{(\frac{1}{\|A^{-1}\|} - \|B-A\|)}$.
    \end{enumerate}
\end{theorem}
\begin{proof}
   \slashn
   \begin{enumerate}
       \item    $\|Bx\| = \|(B-A)x + Ax\| \ge \underbrace{\|Ax\|}_{\ge \frac{1}{\|A^{-1}\|} \|x\|\ (*)} - \underbrace{\|(B-A)x\|}_{\ge \|B-A\|\cdot\|x\|} \ge \underbrace{\left(\frac{1}{\|A^{-1}\|} - \|B-A\|\right)}_{=m}\|x\|$. $(*) \iff \|A^{-1}\|\|Ax\| \ge \|A^{-1}Ax\| = \|x\| \implies \|Ax\| \ge \frac{}{}$

       $\|A^{-1}\| \cdot \|Ax\| \ge \|A^{-1}Ax\| = \|x\|$.
   \item[3.] $\|B^{-1} - A^{-1}\| \le \|B^{-1}\| \|A-B\|\|A^{-1}\|$, а так как $\|B^{-1}\| \le \frac{1}{\frac{1}{\|A^{-1}\|} - \|B-A\|}$.
   \end{enumerate}
\end{proof}
\begin{theorem}
    $f\!: D \subset \R^n \to \R^m$ --- дифференцируема во всех точках $D$ и $\|f'(x)\| \le C$, $D$ --- выпуклая.

    Тогда $\|f(x) - f(y)\| \le C\|x-y\|$.
\end{theorem}
\begin{proof}
    $\vphi(t) = \langle f(x+t(y-x)), f(y)-f(x) \rangle$.  $\vphi\!: [0, 1] \to \R$, $\vphi(0) = \langle f(x), f(y) - f(x) \rangle$,  $\vphi(1) = \langle f(y), f(y) - f(x) \rangle$, откуда  $\underbrace{\vphi(1) - \vphi(0)}_{\vphi'(c)(1-0)} = \|f(y) - f(x)\|^2$.  $\vphi'(c) = \langle f'(x+c(y-x))(y-x), f(y)-f(x) \rangle \le \underbrace{\|f'(x+c(y-x))(y-x)\|}_{\mathclap{\le \|f'(\ldots) \| \|y-x\| \le C\|y-x\|}} \cdot \|f(y)-f(x)\| \le C\|y-x\|\|f(y) - f(x)\|$.
\end{proof}
\begin{theorem}[теорема об обратной функции]
    $D$ --- открытое  $\subset \R^n$,  $x_0 \in D$. $f\!: D \to \R^n$ непрерывно дифференцируема,   $y_0 = f(x_0), A \coloneqq f'(x_0)$ --- обратима.

    Тогда $\exists$ окрестности  $U, V$ точек  $x_0, y_0$, такие, что $f\!: U \to V$ --- обратима и  $f^{-1}\!: V \to U$  непрерывна.
\end{theorem}
\begin{proof}
    $G_y(x) \coloneqq x + A^{-1}(y-f(x))$. Если  $x$ --- неподвижная точка  $G_y$, то $x = x + A^{-1}(y-f(x)) \iff A^{-1}(y-f(x)) = 0$.


    Выбираем  $B_r(x_0)$ так, что $\|A^{-1}\| \|A-f'(x)\| \le \frac{1}{2}\ \forall x \in B_r(x_0)$.

    $G'_y(x) = E + A^{-1}(-f'(x)) = E - A^{-1}f'(x) = A^{-1}(A - f'(x))$. Тогда $\|G'_y(x)\| \le \|A^{-1}\|\|A-f'(x)\| \le \frac{1}{2}\ \forall x \in B_r(x_0)$.

    Хотим, чтобы $G_y\!: B_r(x_0) \to B_r(x_0)$. $\|G_y(x) - x_0\| \le \underbrace{\|G_y(x) - G_y(x_0)\|}_{\le \frac{1}{2} \|x-x_0\| < \frac{r}{2}\ (1)} + \|G_y(x_0) - x_0\| < \frac{r}{2} + \|A^{-1}(y-\underbrace{f(x_0)}_{y_0})\| \le \frac{r}{2} + \|A^{-1}\| \cdot \|y-y_0\| \overset{(*)}{\le} \frac{r}{2} + \|A^{-1}\|R < r$.

    $(*)$ --- берем  $y$ из  $B_R(y_0)$ (причем надо хорошо выбирать $R$, чтобы все оставалось верным), $(1)$ --- воспользовались предыдущей теоремой, так как оценили производную.

    Если $y \in B_R(y_0)$, то $G_y\!: \overline{B}_r(x_0) \to \overline{B}_r(x_0)$ и является сжатием $\implies \forall y \in B_r(x_0) \exists!$ $x_*$ --- неподвижная точка для  $G_y \implies x_* = G_y(x_*) = x_* + A^{-1}(y-f(x_*)) \implies y = f(x_*) \implies y \in f(B_r(x_0))$. 


    $V \coloneqq B_R(y_0)$ и $U \coloneqq f^{-1}(V)$ --- открыто, так как прообраз открыт.

    То есть мы поняли, что $f\!: U \to V$ ---  биекция. Осталось проверить, что  $f^{-1}\!: V \to U$ --- непрерывна.

    Пусть $\widetilde{y} = f(\widetilde{x})$ и  $y = f(x)$,  $x$ --- неподвижная точка  $G_y$ и  $\widetilde{x}$ --- неподвижная в  $G_{\widetilde{y}}$. Тогда  $\|x - \widetilde{x}\| \le \frac{\|G_y(x) - G_{\widetilde{y}}(x)\|}{1-\frac{1}{2}} = 2\|G_y(x) - G_{\widetilde{y}}(x)\| = 2\|A^{-1}(y-f(x)) - A^{-1}(\widetilde{y}-f(x))\| = 2\|A^{-1}(y - \widetilde{y})\| \le 2\|A^{-1}\| \|y-\widetilde{y}\|$ 
\end{proof}
\begin{theorem}
    $f\!: D \subset \R^n \to \R^n$, $D$ --- открытое,  $f(a) = b$,  $f'(a)$ --- обратимая матрица.  $f\!: U \to V$ ---  биекция,  $U, V$ --- окрестности в точках  $a, b$. Тогда  $f^{-1}$ дифференцируема в  $b$ и  $f^{-1}$ непрерывна  $V \to U$.
\end{theorem}
\begin{proof}
    $A = f'(a)$,  $f(a+h) = f(a) + Ah + \alpha(h) \|h\|$, где  $\alpha(h) \xrightarrow{h \to \infty} 0$.

    $k \coloneqq f(a+h) - f(a) = Ah + \alpha(h)\|h\|$, $\|k\| = \|\ldots\| \ge \|Ah\| - \|\alpha(h)\|h\|\| \ge \|h\|(\frac{1}{\|A^{-1}\|} - \|\alpha(h)\|) \ge \|h\|m$, так как $\|Ah\| \ge \frac{\|h\|}{\|A^{-1}\|}$.

    Тогда $k \to 0 \implies h \to 0$.  $A^{-1}k = h + A^{-1}(\alpha(h))\|h\| = f^{-1}(b+k) - f(b) - A^{-1}(\alpha(h))\|h\|$.

    $f^{-1}(b+k) = f^{-1}(b) + A^{-1}k - A^{-1}(\alpha(h)) \|h\|$. Осталось доказать, что  $A^{-1}(\alpha(h))\|h\| = o(\|k\|)$. 

    $A^{-1}\alpha(h) \frac{\|h\|}{\|k\|}$: Первый множитель $\le \|A^{-1}\|\|\alpha(h)\|$, второй $\le \frac{1}{m}$.
\end{proof}
\begin{consequence}
    В условии теоремы об обратной функции $f^{-1}\!: V \to U$ непрерывно дифференцируема.
\end{consequence}
\begin{proof}
    $(f^{-1})'(b) = (f'(a))^{-1}$
\end{proof}
\Subsection{Вступление к неявным функциям}
$x \in \R^n, y \in \R^n$,  $(x, y) \in \R^{n+m} \to \R^m$ линейное.

Если  $A(h, 0) = 0 \implies h = 0$. Тогда уравнение  $A(x, y) = 0$ имеет единственное решение.

$0 = A(x, y) = A(x, 0) + A(0, y) \implies A(x, 0) = -A(0, y)$. Получилась функция  $y \to x \eqqcolon f(y)$,  $A(f(y), y) = 0\ \forall y \in \R^m$. Это неявная функция, определяемая уравнением  $A(x, y) = 0$.

Нелинейный вариант: $x^2 + y^2 = 1$.  $F(x, y) = x^2+y^2=1$,  $F'=(2x,2y)$, если  $y \neq 0$, то $(2x,2y) \begin{pmatrix} 0 \\ k \end{pmatrix}  = 2yk = 0 \iff k = 0$.
\begin{theorem}[о неявной функции]
    $f\!: D \subset \R^{n+m} \to \R^m$,  $(a, b) \in D$, $f(a, b) = 0$.  $f$ --- непрерывно дифференцируема,  $A \coloneqq f'(a, b)$, такая, что  $A(h, 0) = 0 \implies h = 0$.

    Тогда существует такая окрестность $W$ такая, что в  $W$ единственная функция.

     $g\!: W \to \R^n$, такая что  $g(b) = a$ и  $f(g(y), y) = 0\ \forall y \in W$ и эта функция непрерывно дифференцируема. 
\end{theorem}
\begin{proof}
    $F\!: D \to \R^{n+m}$,  $F(x, y) \coloneqq (f(x, y), y)$.  $F(a, b) = (f(a, b), b) = (0, b)$.  $F$ --- непрерывно дифференцируема,  $F(a+h, b+k) = (f(a+h, b+k), b+k) = (f(a, b), b) + (A(h, k), k) + o(\|(h, k)\|)$.

    Проверим, что $F'(a, b)$ --- обратима.  $(A(h, k), k) = 0 \implies k = 0 \implies A(h, 0) \implies h = 0 \implies (h, k) = 0 \implies$ обратима.

    По теорема об обратной функции  $\exists U$ --- окрестность  $(a, b)$,  $V$ --- окрестность в точке  $(0, b)$, такая что  $F\!: U \to V$ --- биекция,  $F^{-1} = G\!: V \to U$ --- непрерывно дифференцируема.

    $(x, y) = G(F(x, y)) = G(f(x, y), y), G(u, v) = (g(u, v), v)$ --- непрерывна дифференцируема $\implies g$ --- непрерывно дифференицируема. Посмотрим $G(0, v) = (g(0, v), v)$. Пусть  $\vphi(v) \coloneqq g(0, v)$,  $W$ --- такая окрестность точки $b$, что  $\{0\}\times W \subset V$.  $\vphi\!: W \to \R^n$,  $f(\vphi(v), v) \overset{?}{=} 0$. 

     $F(\vphi(v), v) = (0, v)$, а так как  $G(0, v) = (g(0, v), v) = (\vphi(v), v)$

     Единственность. Пусть для какого-то $v$ нашлись  $v$ и  $\widetilde{v}$, такая что  $f(u, v) = 0$ и  $f(\widetilde{u}, v) = 0 \implies F(u, v) = (0, v) = F(\widetilde{u}, v)$, но  $F$ биекция $\implies \widetilde{u} = u$.
\end{proof}
\Subsection{Экстремум}
\begin{definition}
    $f\!: E \subset \R^n \to \R$,  $a \in \Int E$.  $a$ --- точка строгого локального минимума, если  $\exists U \subset E$ --- окрестность точки  $a$, такая что  $\forall x \in U\!: f(x) \ge f(a)$.

    Строгий локальный минимум $x \neq a \implies f(x) > f(a)$.

    Максимум тоже самое.
\end{definition}
\begin{theorem}[Необходимые условия экстремума]
    $f\!: E \subset \R^n \to \R$,  $a \in \Int E$. Пусть  $a$ --- точка эстремума. Если существует  $\frac{\partial f}{\partial x_k}(a) \implies \frac{\partial f}{\partial x_k}(a) = 0$.

    В частности, если $f$ дифференцируема в точке  $a$, то  $\frac{\partial f}{\partial x_k}(a) = \ldots = \frac{\partial f}{\partial x_k}(a) = 0$, то есть $\nabla f(a) = 0$.
\end{theorem}
\begin{proof}
    Пусть $U$ --- окрестность  $a$ из определения и  $a$ --- точка  $\min$.

     $g(t) \coloneqq f(t, a_2, a_3, \ldots, a_n)$. Тогда $g(a_1) \le g(t) \implies a_1$ --- точка минимума для $g$ и  $g$ дифференцируема в это точке  $\implies g'(a_1) = 0$.
\end{proof}
\begin{definition}
    Точки, в которой $\nabla f(a) = 0$ --- стационарная.
\end{definition}
\begin{remark}
    Пусть $a$ --- стационарная точка.  $f\!: D \subset \R^n$.

    $f(a+h) = f(a) + \frac{1}{2} \sum\limits_{i, j = 1}^n \frac{\partial^2 f}{\partial x_i \partial x_j}(a) h_i h_j + o(\|h\|^2)$.

    $\frac{f^{(k)}(a)}{k!}h^k$, $k$ --- мультииндекс мощности 2.
\end{remark}
\begin{definition}
    $Q(h) \coloneqq \sum\limits_{i, j = 1}^n c_{ij} \underbrace{h_ih_j}_{=\langle Ch, h\rangle}$ --- квадратичная форма.

    $C \coloneqq (c_{ij})$. Всегда можно считать, что $c_{ij} = c_{ji}$, то есть  $C$ --- симметрическая матрица.
\end{definition}
\begin{definition}
    $Q(h)$ --- положительно определена, если  $Q(h) \ge 0 \forall h$.
    Отрицательно $\le 0$, строго $>/<$.
\end{definition}
\begin{theorem}
    Если $Q(h)$ строго положительно определена, то  $\exists m > 0$, такой что  $Q(h) \ge m \|h\|^2\ \forall h \in \R^n$.
\end{theorem}
\begin{proof}
    $Q$ --- непрерывна на $\R^n$. Рассмотрим на   $S\coloneqq \{x \in \R^n \mid \|x\|=1\}$.  $S$ --- компакт. Тогда  $\exists x_0 \in S$, такая что $0 < Q(x_0) \eqqcolon m$ --- наименьшее значение на  $S$.

    Рассмотрим  $h \neq 0$, $\frac{h}{\|h\|} \in S \implies \frac{1}{\|h\|^2}Q(h) =  Q(\frac{h}{\|h\|}) \ge m \implies Q(h) \ge m\|h\|^2$.
\end{proof}
\begin{theorem}[Достаточные условия экстремума]
    $f\!: D \subset \R^n \to \R$,  $a \in \Int D$.

    $f$ --- дважды дифференцируема в точке  $a$ и  $\nabla f(a) = 0, Q(h) \coloneqq \sum\limits_{i, j = 1}^n \frac{\partial^2 f}{\partial x_i \partial x_j}(a) h_ih_j$. Тогда:
    \begin{enumerate}
        \item Если  $Q(h)$ строго положительно определена, то  $a$ --- точка строгого  $\min$, если строго отрицательно $a$ --- строго  $\min$.
        \item Если  $a$ --- точка нестрого  $\min$, то  $Q$ --- нестрого положительно определена.
        \item  $a$ --- нестрого  $\max \implies Q$ --- нестрого отрицательно.
        \item Если  $Q$ не является знакоопределенной, то  $a$ не точка эстремума.
    \end{enumerate}
\end{theorem}
\begin{proof}
    \begin{enumerate}
        \item $Q(h)$ --- строго положительна  $\implies \exists m > 0\!: Q(h) \ge m \|h\|^2$. Тогда $f(a+h) - f(a) \ge \frac{1}{2}m \|h\|^2 + o(\|h\|^2) = \|h^2\|(\frac{m}{2} + o(1)) > 0$.
        \item[3. ] $h \coloneqq tv$,  $t \in \R, v \in \R^n$.  $f(a+tv) - f(a) = \frac{1}{2}Q(tv) + o(t^2)$. При малых $t$ это равно  $t^2(Q(v) + o(1)) \implies Q(v) \ge 0$
    \end{enumerate}
\end{proof}
\begin{theorem}[Критерий Сильвестера]
    $Q(h) \coloneqq \langle Ch, h\rangle$.  $Q$ --- строго положительно определена  $\iff \det$ всех квадратных миноров с левым верхнем углов совпадающим с левым верхним углом матрицы.
\end{theorem}
\begin{definition}
    Условный экстремум. $f\!: D \subset \R^{n+m} \to \R, \Phi\!: D \to \R^m$,  $a = (b, c) \in D$, внутренняя точка.  $\Phi(a) = 0$.

     $a$ точка условного  $\min$ при условии  $\Phi(x) = 0$, если  $\exists U$ --- окрестность  $a$, такая что  $\forall x \in U\!: \Phi(x) = 0, f(a) \le f(x)$.
\end{definition}
\begin{statement}[Метод неопределенных множителей Лагранжа]
    $f\!: D\subset \R^{n+m} \to \R$,  $\Phi\!: D \to \R^m$ непрерывно дифференцируема, $\Phi = \begin{pmatrix} \Phi_1 \\ \ldots \\ \Phi_{m} \end{pmatrix}$, $a \in \Int D$.

    Если $a$ --- точка локального условного экстремума, то $\nabla f(a), \nabla \Phi_1(a), \nabla \Phi_2(a), \ldots, \nabla \Phi_m(a)$ --- линейно зависимые.
\end{statement}
\begin{remark}
    \begin{enumerate}
        \item Если $\nabla \Phi_1(a), \ldots, \nabla \Phi_m(a)$ зависимые, то тогда теорема ничего не утверждает. 
        \item Если они линейно независимы, то $\exists \lambda_1, \ldots, \lambda_m \in \R\!: \nabla f(a) = \sum \limits_i \lambda_i \nabla \Phi_i(a)$.
        \item $\Phi'(a) = \begin{pmatrix} \nabla \Phi_1(a) \\ \ldots \\ \nabla \Phi_m(a) \end{pmatrix} m$, а так как ЛНЗ $\text{rank}\ \Phi'(a) = m$.
    \end{enumerate}
\end{remark}
\begin{proof}
    Во-первых, считаем, что первый минор ненулевой (можно так перенумеровать столбцы) $\implies \Phi'(a)(h, 0) = 0 \implies h = 0$.

    $a$ --- точка условного локального экстремума ($\min$) и $x = (y, z), y \in \R^m, z \in \R^n \implies a = (b, c)$.  $\Phi(y, z) = 0$ в окрестности  $(b, c)$.

    По теорема о неявной функции $\exists \vphi\!: W \to \R^m$, такая что  $\Phi(\vphi(z), z) \equiv 0\ \forall z \in W \land \vphi(c) = b$, где $W$ --- окрестность точки  $c$.

    Рассмотрим  $g(z) \coloneqq f(\vphi(z), z)$. Подставим $c$: $g(c) = f(\vphi(c), c) = f(a) \implies c$ --- точка локального  $\min$ для $g \implies \nabla g(c) = 0$.

    $g'(z) = \underbrace{f_z'(\vphi(z), z)}_{\substack{\text{часть матрицы производных} \\ \text{для последней координаты}}}+\underbrace{f_y'(\vphi(z), z)}_{\mathclap{\text{\dots для первой}}}\vphi(z)$.  $0 = g'(c) = f_z'(a) + f_y'(a) \vphi'(c)$.

      $\Phi(\vphi(z), z) \equiv 0$ по теореме о неявной функции. Тогда продифференцируем обе части равенства:
      $0 = \Phi_z'(a) + \Phi_y'(a)\vphi'(c)$.  

      Теперь умножим наши $\Phi_z$ и  $\Phi_y$ на вектор $\lambda = (\lambda_1, \ldots, \lambda_m)$. Если справа была нулевая матрица, то после умножения, она ей и останется.

      $0 = g'(c) = f'_z(a) + f'_y(a)\vphi'(c)$ и  $0 = \lambda \Phi'_z(a) + \lambda \Phi_y(a)\vphi'(c)$. Тогда  $0 = (f'_z(a) - \lambda \Phi_z'(a)) + \underbrace{(f_y'(a) - \lambda \Phi_y(a))}_{=0\ \text{при подходящих }\lambda}\vphi'(c)$. А как понять какие $\lambda$ подходят? А все легко: у нас записана какая-то система уравнений для  $\lambda$. Нам надо, чтобы  $\Phi'_y$ была обратима. Для этого, оставим только те столбцы, которые имеют отношение к  $y$, а это первый минор. А она обратима. Тогда остается  $0 = f'_z(a) - \lambda \Phi_z'(a) \iff f'_z(a) = \lambda \Phi_z(a)$.

       $f'_y(a) = \lambda \Phi'_y(a) \land f'_z(a) = \lambda \Phi'_z(a) \implies f'(a) = \lambda \Phi'(a)$.
\end{proof}
